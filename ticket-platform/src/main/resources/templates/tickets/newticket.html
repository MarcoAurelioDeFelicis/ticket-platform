<!DOCTYPE HTML>
<html xmlns:th= "http://www.thymeleaf.org" lang="en">
<head>
	
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!-- Bootstrap CSS -->
	<link th:rel="stylesheet"
		th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css}" />
	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
	
<title>NEW-TICKET</title>
</head>
<body>
	   <header>
	       <nav class="navbar navbar-expand-lg navbar-dark nav-bg">
	           <div class="container-fluid my-o py-0">
<!--				   <img th:src="@{/img/booleanlogo.jpeg}" alt="Logo" class="navbar-logo " width="350px"-->
<!--	                    height="120px" />-->
	               </a>
	           </div>
	       </nav>
	   </header>
	   
	<h1 class="fs-2">Apri un Ticket</h1>
	
	<div class="container">
		<form id="ticket-form"
			      th:object="${ticket}"
			      th:action="@{/newticket/create}"
			      method="post">
				  
				  <div class="container">
					
				  	<div class="text-center">
				  		<div class="card text-center">
				  				    <div class="card-header">
										<input name="title" type="text" class="form-control" id="title"
										         placeholder="Titolo del ticket" th:field="*{title}" th:errorClass="is-invalid">
				  							   <div th:if="${#fields.hasErrors('title')}" class="invalid-feedback">
				  							   				<ul>
				  							   					<li th:each="err : ${#fields.errors('title')}" 
				  							   					    th:text="${err}"></li>
				  							   				</ul>
				  							   </div>				   
									</div>
				  				    <div class="card-body">
				  				      <h5 class="card-title">Scrivi qui il tuo ticket</h5>
				  				      <p class="card-text">
				  						<input name="body" type="text" class="form-control" id="body" 
										          placeholder="Titolo del ticket" th:field="*{body}" th:errorClass="is-invalid">
				  							   <div th:if="${#fields.hasErrors('body')}" class="invalid-feedback">
				  							   				<ul>
				  							   					<li th:each="err : ${#fields.errors('body')}" 
				  							   					    th:text="${err}"></li>
				  							   				</ul>
				  							   			  </div>
				  					  </p>
				  				      <button class="btn btn-primary">Save</button>
				  				    </div>
				  					<div th:unless="${listaTicket.isEmpty()}">
				  								<ul>
				  									<li th:each="ticket: ${listaTicket}">
				  										<p th:text="${ticket.ticket}" ></p>
				  									</li>
				  								</ul>
				  							</div>
				  							<div th:if="${listaTicket.isEmpty()}">
				  								<p> Non ci sono ancora TICKET aperti. </p>
				  							</div>
											<div th:unless="${listaCategorie.isEmpty()}">
														<ul>
															<li th:each="categoria: ${listaCategorie}">
																<p th:text="${categoria.category}" ></p>
															</li>
														</ul>
													</div>
													<div th:if="${listaCategorie.isEmpty()}">
														<p> Non ci sono ancora categorie. </p>
													</div>
				  				  </div>
				  					</div>
				  				  </div>		
		</form>
		<thead>
		                            <tr class="fs-4">
		                                <th scope="col">Data</th>
		                                <th scope="col">Titolo</th>
		                                <th scope="col">Contenuto</th>
		                                <th scope="col" width="160px">Assegnato a</th>
		                                <th scope="col"></th>
		                            </tr>
		                        </thead>
		
		                        <!-- Tbody -->
		
		                        <tbody>
		
		                            <tr th:each="ticket : ${list}" class="fs-6">
		                                <td>
		                                    <div class="pt-2" th:text="${ticket.ticket_date}">
		                                    </div>
		                                </td>
		                                <td>
		                                    <div class="pt-2" th:text="${ticket.title}">
		                                    </div>
		                                </td>
		                                <td>
		                                    <div class="pt-2" th:text="${ticket.body}">
		                                    </div>
		                                </td>
		                                <td>
		                                    <div class="pt-2" th:text="${ticket.user.username}">
		                                    </div>
		                                </td>
		
		
		                                <td>
		                                    <div class="d-flex justify-content-evenly">
		                                        <a class="btn icon-link icon-link-hover text-decoration-none"
		                                            th:href="@{|/newticket/${ticket.id}|}">
		                                            <i class="bi bi-search"></i>
		                                        </a>
		                                        <a class="btn icon-link icon-link-hover text-decoration-none"
		                                            th:href="@{|/newticket/${ticket.id}/show|}">
		                                            <i class="bi bi-pencil-fill"></i>
		                                        </a>
		
												<form th:action="@{'/newticket/delete/{id}'(id=${ticket.id})}"
														method="post">
													<button class="btn btn-danger" type="submit" id="submitButton"
													   th:data-confirm-delete="|Sei sicuro di voler cancellare il ticket?|"
														onclick="if(!confirm(this.getAttribute('data-confirm-delete'))) return false">
														<i class="bi bi-trash"></i>
													</button>
												</form>
		                                     </div>
											
											
<!--		<tr th:each="ticket : ${list}">-->
<!--							<td th:text="${ticket.title}">1</td>-->
<!--							<td th:text="${user.username}">2</td>-->
<!--							<td th:text="${ticket.user}">2</td>-->
		
<!--							<td class="d-flex justify-content-center gap-2" >-->
<!--								<a class="btn btn-primary"-->
<!--									th:href="@{|/newticket/show/${ticket.id}|}"> <i class="bi bi-book"></i>-->
<!--								</a> <a class="btn btn-primary"-->
<!--									th:href="@{|/newticket/edit/${ticket.id}|}"> <i-->
<!--										class="bi bi-pencil-square-sq"></i>-->
<!--								</a>-->
<!--								<form th:action="@{'/newticket/delete/{id}'(id=${ticket.id})}"-->
<!--									method="post">-->
<!--									<button class="btn btn-danger" type="submit" id="submitButton"-->
<!--										th:data-confirm-delete="|Sei sicuro di voler cancellare il ticket?|"-->
<!--										onclick="if(!confirm(this.getAttribute('data-confirm-delete'))) return false">-->
<!--										<i class="bi bi-trash"></i>-->
<!--									</button>-->
<!--								</form>-->
<!--							</td>-->
<!--						</tr>-->
	</div>
	
	<script th:src="@{/webjars/bootstrap/5.1.3/js/bootstrap.bundle.min.js}"></script>	
</body>
</html>